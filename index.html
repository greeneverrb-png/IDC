<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Identify Chords</title>

<style>
:root{
  --bg:#0b0e1a;
  --card:#151a33;
  --accent:#00e0ff;
  --muted:#9aa0c7;
}

body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:var(--bg);
  color:white;
}

header{
  text-align:center;
  padding:14px;
  font-size:20px;
  font-weight:600;
}

.container{max-width:900px;margin:auto;padding:14px;}
.card{background:var(--card);border-radius:14px;padding:16px;margin-bottom:14px;}

button,select,input[type=file]{
  background:#22286a;
  border:none;
  border-radius:10px;
  color:white;
  padding:14px 18px;
  font-size:16px;
}

button:disabled{opacity:.4}
.controls{display:flex;gap:10px;flex-wrap:wrap}

.chords{
  height:160px;
  background:#060914;
  border-radius:12px;
  display:flex;
  align-items:center;
  overflow:hidden;
}

.scroll{
  display:flex;
  gap:60px;
  padding-left:20px;
}

.chord{
  font-size:36px;
  font-weight:700;
  color:#6c72a8;
}

.chord.active{
  color:var(--accent);
  transform:scale(1.5);
  text-shadow:0 0 14px rgba(0,224,255,.6);
}

.fullscreen{
  position:fixed;
  inset:0;
  background:black;
  z-index:999;
  padding:20px;
}

.fullscreen .chord{font-size:70px}

.time{font-size:12px;color:var(--muted);display:flex;justify-content:space-between}
</style>
</head>

<body>

<header>üé∏ Identify Chords</header>

<div class="container">

<div class="card">
  <input type="file" id="file" accept=".mp3">
</div>

<div class="card">
  <div class="controls">
    <button id="play" disabled>‚ñ∂Ô∏è</button>
    <button id="loopA">Set A</button>
    <button id="loopB">Set B</button>
    <button id="loopToggle">üîÅ Off</button>

    <select id="scale">
      <option>C</option><option>C#</option><option>D</option><option>D#</option>
      <option>E</option><option>F</option><option>F#</option><option>G</option>
      <option>G#</option><option>A</option><option>A#</option><option>B</option>
      <option>Cm</option><option>C#m</option><option>Dm</option><option>D#m</option>
      <option>Em</option><option>Fm</option><option>F#m</option><option>Gm</option>
      <option>G#m</option><option>Am</option><option>A#m</option><option>Bm</option>
    </select>
  </div>

  <input type="range" id="seek" value="0">
  <div class="time"><span id="cur">0:00</span><span id="dur">0:00</span></div>
</div>

<div class="card" id="chordCard">
  <button onclick="toggleFull()">‚õ∂ Full</button>
  <div class="chords">
    <div class="scroll" id="scroll"></div>
  </div>
</div>

</div>

<audio id="audio"></audio>

<script>
const audio = document.getElementById("audio");
const playBtn = document.getElementById("play");
const scroll = document.getElementById("scroll");
const seek = document.getElementById("seek");
const cur = document.getElementById("cur");
const dur = document.getElementById("dur");

let loopA=null, loopB=null, loopOn=false;

/* EXACT CHORD TIMELINE (sample) */
const chordTimeline = [
  {time:0,chord:"C#m"},
  {time:12,chord:"A"},
  {time:24,chord:"E"},
  {time:36,chord:"B"},
];

/* Load */
file.onchange=e=>{
  const f=e.target.files[0];
  if(!f)return;
  audio.src=URL.createObjectURL(f);
  audio.load();
};

/* Ready */
audio.onloadedmetadata=()=>{
  dur.textContent=format(audio.duration);
  playBtn.disabled=false;
};

/* Build chords ONLY when play */
function buildChords(){
  scroll.innerHTML="";
  chordTimeline.forEach(c=>{
    const d=document.createElement("div");
    d.className="chord";
    d.textContent=c.chord;
    scroll.appendChild(d);
  });
}

/* Play */
playBtn.onclick=()=>{
  if(audio.paused){
    if(!scroll.children.length) buildChords();
    audio.play();
    playBtn.textContent="‚è∏";
  }else{
    audio.pause();
    playBtn.textContent="‚ñ∂Ô∏è";
  }
};

/* Sync */
audio.ontimeupdate=()=>{
  seek.value=(audio.currentTime/audio.duration)*100;
  cur.textContent=format(audio.currentTime);

  const chords=[...scroll.children];
  chords.forEach(c=>c.classList.remove("active"));

  for(let i=chordTimeline.length-1;i>=0;i--){
    if(audio.currentTime>=chordTimeline[i].time){
      chords[i]?.classList.add("active");
      scroll.style.transform=`translateX(${-i*120}px)`;
      break;
    }
  }

  if(loopOn && loopB && audio.currentTime>=loopB){
    audio.currentTime=loopA;
  }
};

/* Loop A/B */
loopA.onclick=()=>loopA=audio.currentTime;
loopB.onclick=()=>loopB=audio.currentTime;
loopToggle.onclick=()=>{
  loopOn=!loopOn;
  loopToggle.textContent=loopOn?"üîÅ On":"üîÅ Off";
};

seek.oninput=()=>audio.currentTime=(seek.value/100)*audio.duration;

function format(t){
  const m=Math.floor(t/60);
  const s=Math.floor(t%60).toString().padStart(2,"0");
  return `${m}:${s}`;
}

function toggleFull(){
  document.getElementById("chordCard").classList.toggle("fullscreen");
}
</script>

</body>
</html>
